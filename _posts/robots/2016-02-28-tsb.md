---
layout: article
title: TinySafeBoot, Arduino, and Wireless Upload to ATtiny85
categories: robots
excerpt:
tags: [robots]
color: "#152a55"
image:
  feature: tsb_logo.png
  teaser: tsb_logo.png
  thumb:
comments: true
---

### The Dream

For awhile now I've dreamt of a PCB which would have everything I need on it: uC, H-bridges, PSU, Lipo charger, inductive power collector, _and_ a wirelesss device which would allow wireless uploading to the uC.  

A lot of failed attempts, some as long as writing my own uploader for the LPC1114, others as "simple" as hacking away at the Arduino IDE source.  However, I finally found a winning combination: TinySafeBoot, Arduino IDE, and most Atmega and ATtiny Atmel chips.

### TinySafeBoot

TinySafeBoot is a pretty neat GPL project which is around 500 bytes.  It allows for selecting of any two pins as RX / TX for two-wire communication.  Or! It has a one-wire protocol.

[TinySafeBoot](http://jtxp.org/tech/tinysafeboot_en.htm)

The part which makes TSB such a great choice for wireless bootloading is its serial communication protocol.  Unlike the hardware protocol Arduino uses, serial communication allows the remote device to control the bootloaders workflow without flipping any hardware pins.  Contrast this against the Arduino bootloader (I think it's optiboot now?) which focuses on resetting the device repeatedly to activate the bootloader.

The hardware doesn't work well is there is no quick way to flip pins on my focused (cheap) wireless devices, the HM-1X and ESP8266.  This means the remote device will have difficulty putting the target uC into bootloader mode.

Of course, TSB has other great features like auto-bauding and password protection, etc.  It's not perfect, but I like it for its simplicity.

### Getting TSB Setup

I have tested TSB on three devices, the ATtiny85 and an ATmega328P.  However, I've also tested on an ATtiny1634 which didn't work.

There are two parts to TSB,

1. Firmware
2. [Software](http://jtxp.org/tech/tinysafeboot_en.htm)

[![](/images/TSB_software_click.png)](http://jtxp.org/tech/tinysafeboot_en.htm)

However, we are going to stick with downloading the software since it allows you to generate "custom" firmware for whatever chip you are targeting.
